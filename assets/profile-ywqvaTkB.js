import{l as c}from"./load_navbar-D39noM3e.js";import{A as d}from"./constantes-B-0QMk3S.js";localStorage.getItem("token");const n=JSON.parse(localStorage.getItem("user")),u=document.getElementById("editBtn"),l=document.getElementById("editForm"),f=document.getElementById("submitEdit"),y=document.getElementById("deleteBtn"),E=document.getElementById("username");c();async function g(){try{const t=n.id||"1";document.getElementById("username").textContent=n.username||"Username",document.getElementById("profilePic").src=`/profiles/user${t}.jpg`,document.getElementById("email").textContent=n.email||"Email",document.getElementById("name").textContent=n.first_name||"Name",document.getElementById("lastName").textContent=n.last_name||"Last Name"}catch(t){console.error("Error loading profile:",t)}}u.addEventListener("click",()=>{l.classList.toggle("hidden")});f.addEventListener("click",async()=>{const t=document.getElementById("newUserName").value.trim(),a=document.getElementById("newEmail").value.trim(),r=document.getElementById("newName").value.trim(),m=document.getElementById("newLastName").value.trim(),o=document.getElementById("newPassword").value.trim(),i=document.getElementById("confirmPassword").value.trim();if(o!==i){alert("Passwords do not match.");return}const e={};t!==""&&(e.username=t),a!==""&&(e.email=a),r!==""&&(e.first_name=r),m!==""&&(e.last_name=m),o!==""&&(e.password=o);try{(await fetch(`${d}/users/${n.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(E.textContent=t,e.username&&(document.getElementById("username").textContent=e.username),e.first_name&&(document.getElementById("name").textContent=e.first_name),e.last_name&&(document.getElementById("lastName").textContent=e.last_name),e.email&&(document.getElementById("email").textContent=e.email),alert("Profile updated successfully."),l.classList.add("hidden")):alert("Failed to update profile.")}catch(s){console.error("Update error:",s),alert("Error updating profile.")}});y.addEventListener("click",async()=>{if(confirm("Are you sure you want to delete your account?"))try{(await fetch(`${d}/users/${n.id}`,{method:"DELETE"})).ok?(alert("Account deleted successfully."),window.location.href="/html/index.html"):alert("Failed to delete account.")}catch(t){console.error("Delete error:",t),alert("Error deleting account.")}});g();
