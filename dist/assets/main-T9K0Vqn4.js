import{A as l}from"./constantes-B-0QMk3S.js";import{l as m}from"./index-BLRFddlS.js";function p(){const e=document.getElementById("loginForm"),r=document.getElementById("signupForm"),u=m(l);e&&e.addEventListener("submit",async n=>{n.preventDefault();const a=e.querySelector('input[type="email"]').value,i=e.querySelector('input[type="password"]').value;try{const t=await fetch(`${l}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:i})}),o=await t.json();t.ok?(localStorage.setItem("token",o.access_token),localStorage.setItem("user",JSON.stringify(o.user)),u.emit("user_logged_in",{id:o.user.id,username:o.user.username}),console.log("Login exitoso:",o),window.location.href="main.html"):alert(o.message||"Login fallido")}catch(t){console.error("Error en login:",t),alert("Error de red.")}}),r&&r.addEventListener("submit",async n=>{n.preventDefault();const a=r.querySelector('input[type="email"]').value,i=r.querySelector('input[type="password"]').value,t=r.querySelector('input[placeholder="Username"]').value,o=r.querySelector('input[placeholder="First Name"]').value,d=r.querySelector('input[placeholder="Last Name"]').value;try{const s=await fetch(`${l}/auth/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:i,username:t,first_name:o,last_name:d})}),c=await s.json();s.ok?(console.log("Registro exitoso:",c),window.location.href="index.html"):alert(c.message||"Signup fallido")}catch(s){console.error("Error en signup:",s),alert("Error de red.")}})}p();"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(e=>console.log("[SW] Registrado:",e.scope)).catch(e=>console.error("[SW] Error:",e))});
